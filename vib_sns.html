<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vib â€“ ã™ã‚Œé•ã„ã§å…±æ„ŸãŒã¤ãªãŒã‚‹SNSï¼ˆç™ºè¡¨ç”¨HTMLåŸå‹ï¼‰</title>
  <style>
    :root{
      --bg:#0b1020;              /* æ·±ã„å®‡å®™è‰² */
      --fg:#e6f4ff;              /* æ–‡å­—ï¼ˆé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰ */
      --muted:#9bbad1;           /* è£œåŠ©ãƒ†ã‚­ã‚¹ãƒˆ */
      --brand:#66e3ff;           /* ã‚·ã‚¢ãƒ³å¯„ã‚Šãƒã‚ªãƒ³ */
      --brand-2:#9e7bff;         /* ç´«å¯„ã‚Šãƒã‚ªãƒ³ */
      --danger:#ff7aa2;          /* ãƒ”ãƒ³ã‚¯ */
      --glass:rgba(255,255,255,.06);
      --stroke:rgba(255,255,255,.14);
      --ok:#67fdb4;              /* å…±æ„ŸOKã®ç·‘ */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic UI","Noto Sans JP",sans-serif;
      color:var(--fg); background:
        radial-gradient(1200px 600px at 80% -20%, rgba(102,227,255,.15), transparent),
        radial-gradient(1200px 600px at 10% 120%, rgba(158,123,255,.14), transparent),
        linear-gradient(180deg, #0b1020 0%, #060914 100%);
      letter-spacing:.2px;
       overflow-x: hidden;
       overflow-y: auto;
    }
    a{color:inherit}

    /* ===== Onboarding (full screen) ===== */
    #onboarding{position:fixed; inset:0; display:grid; place-items:center; z-index:20;}
    .ob-bg{position:absolute; inset:0; background:
      radial-gradient(900px 500px at 80% -10%, rgba(102,227,255,.18), transparent),
      radial-gradient(800px 500px at 10% 110%, rgba(158,123,255,.18), transparent),
      linear-gradient(180deg,#080d1b,#060912 70%);
    }
    .ob-grid{position:absolute; inset:0; opacity:.18; pointer-events:none; background-image:
      linear-gradient(to right, rgba(255,255,255,.08) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size:34px 34px;
      mask-image: radial-gradient(72% 62% at 50% 40%, black 60%, transparent 100%);
    }
    .ob-card{position:relative; width:min(520px,92vw); border-radius:22px; padding:24px 22px; text-align:center; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); box-shadow:0 0 50px rgba(102,227,255,.25)}
    .logo-xl{display:flex; align-items:center; justify-content:center; gap:12px; font-weight:700; letter-spacing:.4px; font-size:22px;}
    .logo-xl .mark{width:20px; height:20px; border-radius:50%; background: radial-gradient(10px 10px at 50% 50%, var(--brand), transparent); box-shadow:0 0 18px var(--brand), 0 0 30px rgba(102,227,255,.5);}

    .ob-actions{display:flex; gap:12px; justify-content:center; margin-top:16px; flex-wrap:wrap}
    .ob-btn{border:1px solid var(--stroke); color:var(--fg); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02)); border-radius:12px; padding:12px 16px; cursor:pointer}
    .ob-btn.primary{border-color:rgba(102,227,255,.5); box-shadow:0 0 22px rgba(102,227,255,.2)}
    .ob-input{width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--stroke); background:rgba(255,255,255,.04); color:var(--fg); font-size:16px}

    .hide{display:none !important}

    /* Entry Animation */
    #entryAnim{position:absolute; inset:0; display:none; place-items:center; backdrop-filter: blur(4px);
      background:radial-gradient(900px 600px at 50% 50%, rgba(102,227,255,.08), rgba(6,9,20,.78));}
    #entryAnim.show{display:grid}
    .entry-wrap{position:relative; width:min(680px,92vw); height:320px; border-radius:22px; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); overflow:hidden; box-shadow:0 0 50px rgba(102,227,255,.25)}
    .pt{position:absolute; width:3px; height:3px; border-radius:50%; background:radial-gradient(circle at 30% 30%, var(--brand), rgba(102,227,255,.0)); opacity:.85; animation: drift 4.5s linear infinite;}
    @keyframes drift{from{transform:translate(var(--sx),var(--sy)); opacity:.3} to{transform:translate(var(--ex),var(--ey)); opacity:.85}}
    .ring{position:absolute; left:50%; top:50%; width:20px; height:20px; border-radius:50%; border:2px solid rgba(102,227,255,.6); transform:translate(-50%,-50%); filter:drop-shadow(0 0 12px rgba(102,227,255,.8)); animation:ripple 1.7s ease-out 0s infinite}
    .ring.r2{animation-delay:.35s}
    .ring.r3{animation-delay:.7s}
    @keyframes ripple{from{opacity:.9; width:20px; height:20px} to{opacity:0; width:560px; height:560px}}
    .beam{position:absolute; left:10%; right:10%; top:50%; height:2px; transform:translateY(-50%); background:linear-gradient(90deg, transparent, var(--brand), var(--brand-2), transparent); filter:blur(.2px); animation: flow 1.8s linear infinite}
    @keyframes flow{to{background-position:200% 0}}
    .entry-text{position:absolute; inset:auto 0 16px 0; text-align:center; color:var(--muted)}

    /* ===== App (phone frame) ===== */
    .stage{min-height:100%; display:none; place-items:center; padding:24px}
    .phone{width: 380px; max-width: 92vw; height: 760px; max-height: 92vh; position:relative; border-radius:28px; padding:1px; background: linear-gradient(145deg, rgba(102,227,255,.55), rgba(158,123,255,.55)); box-shadow: 0 0 50px rgba(102,227,255,.25), 0 0 120px rgba(158,123,255,.15);}
    .screen{height:100%; border-radius:27px; overflow:hidden; position:relative; background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); backdrop-filter: blur(6px);}
    .grid{position:absolute; inset:0; pointer-events:none; opacity:.18; background-image:
      linear-gradient(to right, rgba(255,255,255,.08) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size:28px 28px; mask-image: radial-gradient(70% 60% at 50% 40%, black 60%, transparent 100%);
    }

    /* Top bar */
    .topbar{display:flex; align-items:center; gap:10px; padding:14px 16px; border-bottom:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.01));}
    .logo{font-weight:700; letter-spacing:.5px; display:flex; align-items:center; gap:10px}
    .logo .mark{width:18px; height:18px; border-radius:50%; position:relative; background: radial-gradient(10px 10px at 50% 50%, var(--brand), transparent); box-shadow: 0 0 18px var(--brand), 0 0 30px rgba(102,227,255,.5);}
    .energy{margin-left:auto; height:2px; flex:1; background:linear-gradient(90deg, transparent, var(--brand), var(--brand-2), transparent); filter:blur(.4px); opacity:.8}

    /* Tabs */
    .tabs{display:grid; grid-template-columns:repeat(4,1fr);} .tab{padding:12px 6px; text-align:center; font-size:12px; color:var(--muted); border-bottom:1px solid var(--stroke); cursor:pointer; user-select:none; background:rgba(255,255,255,.02)} .tab.active{color:var(--fg); background:linear-gradient(180deg, rgba(102,227,255,.12), rgba(158,123,255,.07));}

    /* Views */
    .view{display:none; height:calc(100% - 112px); overflow:auto; padding:16px;} .view.active{display:block}

    /* Home */
    .card{background:var(--glass); border:1px solid var(--stroke); border-radius:16px; padding:14px 14px; margin-bottom:12px; position:relative; overflow:hidden}
    .card h3{margin:2px 0 8px; font-size:15px}
    .badge{display:inline-flex; align-items:center; gap:6px; border:1px solid var(--stroke); border-radius:999px; padding:4px 10px; font-size:12px; color:var(--muted);} .vibe-dot{width:8px; height:8px; border-radius:50%; background:radial-gradient(circle at 40% 40%, var(--brand), #0ff0); box-shadow:0 0 12px var(--brand)}
    .glow-like{position:absolute; right:12px; top:12px; padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid var(--stroke); cursor:pointer; background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03))} .glow-like.active{box-shadow:0 0 18px var(--ok); border-color:rgba(103,253,180,.5);}

    /* Radar */
    .radar-wrap{display:grid; place-items:center; margin-top:8px}
    .radar{width: 260px; height:260px; border-radius:50%; background:
        radial-gradient(60px 60px at 50% 50%, rgba(102,227,255,.2), transparent 60%),
        conic-gradient(from 0deg, rgba(102,227,255,.0), rgba(102,227,255,.2), rgba(158,123,255,.0)); border:1px solid var(--stroke); position:relative; overflow:hidden; box-shadow: inset 0 0 40px rgba(102,227,255,.2), 0 0 40px rgba(102,227,255,.2); animation: spin 9s linear infinite;}
    .radar::after{content:""; position:absolute; inset:-2px; border-radius:50%; background: radial-gradient(120px 120px at 50% 50%, rgba(158,123,255,.18), transparent); animation: pulse 2.6s ease-in-out infinite; pointer-events:none;}
    @keyframes spin{to{transform:rotate(360deg)}} @keyframes pulse{0%,100%{opacity:.35}50%{opacity:.1}}
    .radar-btns{display:flex; gap:10px; justify-content:center; margin-top:12px}
    .btn{border:1px solid var(--stroke); color:var(--fg); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02)); border-radius:12px; padding:10px 14px; cursor:pointer}
    .btn.primary{border-color:rgba(102,227,255,.5); box-shadow:0 0 22px rgba(102,227,255,.2)}

    .encounter{margin-top:14px; padding:14px; border-radius:14px; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(102,227,255,.08), rgba(158,123,255,.08));}
    .encounter .row{display:flex; align-items:center; gap:12px}
    .avatar{width:44px; height:44px; border-radius:50%; display:grid; place-items:center; font-size:22px; background: radial-gradient(circle at 40% 40%, rgba(102,227,255,.35), rgba(158,123,255,.15)); border:1px solid var(--stroke)}
    .compat{margin-left:auto; font-weight:700; color:var(--ok)}

    /* Match overlay */
    .overlay{position:absolute; inset:0; display:none; place-items:center; background:linear-gradient(180deg, rgba(6,9,20,.3), rgba(6,9,20,.7)); backdrop-filter: blur(6px);} .overlay.show{display:grid}
    .match{width: 86%; border-radius:18px; padding:18px; text-align:center; background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); border:1px solid var(--stroke); box-shadow:0 0 40px rgba(102,227,255,.25);} .pair{display:flex; justify-content:center; align-items:center; gap:18px; margin:14px 0}
    .beam-sm{height:2px; width:120px; background:linear-gradient(90deg, transparent, var(--brand), var(--brand-2), transparent); filter:blur(.2px); animation: flow 1.8s linear infinite}

    /* Profile */
    .stats{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
    .stat{padding:12px; border-radius:12px; border:1px solid var(--stroke); background:var(--glass); text-align:center}
    .stat b{font-size:18px; display:block; margin-bottom:4px}
    .history{margin-top:8px}
    .history .item{display:flex; align-items:center; gap:10px; padding:10px; border:1px solid var(--stroke); border-radius:12px; background:rgba(255,255,255,.03); margin-bottom:8px}
    .meta{font-size:12px; color:var(--muted)}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <!-- ========== ONBOARDING ========== -->
  <div id="onboarding">
    <div class="ob-bg"></div>
    <div class="ob-grid"></div>

    <!-- Step 1: Welcome -->
    <div id="welcomeScreen" class="ob-card">
      <div class="logo-xl"><span class="mark"></span>Vib <span class="muted">/ Empatia</span></div>
      <p class="muted" style="margin:.6rem 0 0">è¨€è‘‰ã¯ã„ã‚‰ãªã„ã€‚æ„Ÿã˜ã‚‹ã ã‘ã§ã€ä¸–ç•Œã¨ã¤ãªãŒã‚‹ã€‚</p>
      <div class="ob-actions">
        <button class="ob-btn primary" onclick="goName()">ã¯ã˜ã‚ã‚‹</button>
      </div>
    </div>

    <!-- Step 2: Nickname -->
    <div id="nameScreen" class="ob-card hide">
      <div class="logo-xl"><span class="mark"></span>ã‚ãªãŸã®æ³¢é•·å</div>
      <input id="nickInput" class="ob-input" placeholder="ä¾‹ï¼‰Soraã€Mioã€Kaiâ€¦" autocomplete="off" />
      <div class="ob-actions">
        <button class="ob-btn" onclick="autoFill()">è‡ªå‹•ã§æ±ºã‚ã‚‹</button>
        <button class="ob-btn primary" onclick="startSync()">Sync!ï¼ˆåŒæœŸé–‹å§‹ï¼‰</button>
      </div>
      <p class="muted" style="margin-top:6px; font-size:12px">â€» æ‰‹å…¥åŠ›ã‚‚è‡ªå‹•ç”Ÿæˆã‚‚OKã€‚ã‚ã¨ã§ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™ã€‚</p>
    </div>

    <!-- Step 3: Entry Animation -->
    <div id="entryAnim">
      <div class="entry-wrap" id="entryWrap">
        <div class="ring"></div>
        <div class="ring r2"></div>
        <div class="ring r3"></div>
        <div class="beam"></div>
        <div class="entry-text" id="entryText">å…±æ„Ÿãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ¥ç¶šä¸­â€¦</div>
      </div>
    </div>
  </div>

  <!-- ========== APP ========== -->
  <div class="stage" id="stage">
    <div class="phone">
      <div class="screen">
        <div class="grid"></div>
        <div class="topbar">
          <div class="logo"><span class="mark"></span>Vib <span class="muted">/ Empatia</span></div>
          <div class="energy"></div>
        </div>
        <div class="tabs">
          <div class="tab active" data-view="home">ãƒ›ãƒ¼ãƒ </div>
          <div class="tab" data-view="radar">ãƒ¬ãƒ¼ãƒ€ãƒ¼</div>
          <div class="tab" data-view="matches">ãƒãƒƒãƒ</div>
          <div class="tab" data-view="profile">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</div>
        </div>

        <!-- VIEWS -->
        <section id="home" class="view active">
          <div class="card">
            <button class="glow-like" onclick="toggleLike(this)">éè¨€èªã„ã„ã­</button>
            <h3>ã‚ˆã†ã“ãã€<span id="welcomeName">ã‚ãªãŸ</span> ã•ã‚“</h3>
            <div class="badge"><span class="vibe-dot"></span> ä»Šæ—¥ã®æ³¢é•·ï¼šç©ã‚„ã‹ã• + é›†ä¸­</div>
            <p class="muted" style="margin-top:8px">ã‚ãªãŸã®å…±æ„Ÿãƒ¬ãƒ™ãƒ«ã¯ <b>72</b>ã€‚è¡—ã‚’æ­©ãã¨ã€ä¼¼ãŸæ³¢é•·ã®äººã«å…‰ã®ã‚†ã‚‰ããŒèµ°ã‚Šã¾ã™ã€‚</p>
          </div>

          <div class="card">
            <h3>æœ€è¿‘ã®å…±é³´</h3>
            <div class="badge"><span class="vibe-dot"></span> ã‚«ãƒ•ã‚§ã§ã®é™ã‘ã•</div>
            <p class="muted" style="margin-top:8px">åˆå‰ 10:12ã€æ–°å®¿ä¸‰ä¸ç›®ã§åŒèª¿ã‚·ã‚°ãƒŠãƒ«ã‚’å—ä¿¡ã€‚éè¨€èªã€Œã„ã„ã­ï¼ã€ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚</p>
          </div>

          <div class="card">
            <h3>ä¸–ç•Œè¦³ï¼ˆã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼‰</h3>
            <p class="muted">è¨€è‘‰ã¯ã„ã‚‰ãªã„ã€‚æ„Ÿã˜ã‚‹ã ã‘ã§ã€ä¸–ç•Œã¨ã¤ãªãŒã‚‹ã€‚<br>ã™ã‚Œé•ã„ã®ä¸€ç¬ã«ã€ã‚„ã•ã—ã„å…±é³´ã‚’ã€‚</p>
          </div>
        </section>

        <section id="radar" class="view">
          <div class="radar-wrap">
            <div class="radar" id="radar"></div>
          </div>
          <div class="radar-btns">
            <button class="btn" onclick="fakeWalk()">â†» å‘¨å›²ã‚¹ã‚­ãƒ£ãƒ³</button>
            <button class="btn primary" onclick="simulateEncounter()">â˜… ã™ã‚Œé•ã„ã‚’ç™ºç”Ÿ</button>
          </div>
          <div id="encounterZone"></div>
        </section>

        <section id="matches" class="view">
          <div class="card">
            <h3>ãƒãƒƒãƒï¼†å…±æ„Ÿå±¥æ­´</h3>
            <div id="matchList" class="history"></div>
            <p class="muted" id="noMatchMsg">ã¾ã å…±æ„Ÿå±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ¬ãƒ¼ãƒ€ãƒ¼ã§ã€Œâ˜… ã™ã‚Œé•ã„ã‚’ç™ºç”Ÿã€ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚</p>
          </div>
        </section>

        <section id="profile" class="view">
          <div class="stats">
            <div class="stat"><b id="statVibes">0</b><span class="muted">éè¨€èªã„ã„ã­</span></div>
            <div class="stat"><b id="statEncounters">0</b><span class="muted">ã™ã‚Œé•ã„</span></div>
            <div class="stat"><b id="statMatches">0</b><span class="muted">ãƒãƒƒãƒ</span></div>
          </div>

          <div class="card" style="margin-top:12px">
            <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h3>
            <p class="muted">æ³¢é•·ã‚¿ã‚¤ãƒ—ï¼šè½ã¡ç€ã / å¥½å¥‡å¿ƒ / æ€ã„ã‚„ã‚Š<br>ãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼šæ—¥å¸¸ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ãªå…±é³´ã‚’ã€‚</p>
          </div>

          <div class="card">
            <h3>ä½“é¨“ã‚’ãƒªã‚»ãƒƒãƒˆ</h3>
            <p class="muted">å†ã³å…¥å ´ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ä½“é¨“ã—ãŸã„å ´åˆã¯ã“ã¡ã‚‰ã€‚</p>
            <button class="btn primary" onclick="resetOnboarding()">å†ä½“é¨“ã™ã‚‹</button>
          </div>

          <div class="card">
            <h3>æœ€è¿‘ã®å…±é³´ãƒ­ã‚°</h3>
            <div id="history" class="history"></div>
          </div>
        </section>

        <!-- Overlay: Match animation -->
        <div class="overlay" id="overlay">
          <div class="match">
            <div class="muted">Non-Verbal Match</div>
            <div class="pair">
              <div class="avatar" id="me">ğŸ™‚</div>
              <div class="beam-sm"></div>
              <div class="avatar" id="other">ğŸ«¶</div>
            </div>
            <div id="matchText" style="margin-bottom:12px">å…±æ„Ÿãƒªãƒ³ã‚¯ã‚’ç¢ºç«‹ä¸­â€¦</div>
            <button class="btn" onclick="closeOverlay()">é–‰ã˜ã‚‹</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Onboarding flow =====
    const onboarding = document.getElementById('onboarding');
    const welcomeScreen = document.getElementById('welcomeScreen');
    const nameScreen = document.getElementById('nameScreen');
    const entryAnim = document.getElementById('entryAnim');
    const entryWrap = document.getElementById('entryWrap');
    const entryText = document.getElementById('entryText');
    const nickInput = document.getElementById('nickInput');
    const stage = document.getElementById('stage');
    const welcomeName = document.getElementById('welcomeName');

    const seedNames = ['Sora','Ren','Aoi','Mio','Kai','Yui','Noa','Haru','Rio','Nagi','Luna','Nova','Rei'];
    const seedAffix = ['Wave','Pulse','Echo','Flux','Aura','Nova','Beam','Holo'];

    function goName(){
      welcomeScreen.classList.add('hide');
      nameScreen.classList.remove('hide');
      nickInput.focus();
    }

    function autoFill(){
      const base = seedNames[Math.floor(Math.random()*seedNames.length)];
      const aff = seedAffix[Math.floor(Math.random()*seedAffix.length)];
      const num = String(Math.floor(100 + Math.random()*899));
      nickInput.value = `${aff}_${base}-${num}`;
    }

    function startSync(){
      const name = (nickInput.value || '').trim() || seedNames[Math.floor(Math.random()*seedNames.length)];
      localStorage.setItem('vib_name', name);
      entryText.textContent = 'å…±æ„Ÿãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ¥ç¶šä¸­â€¦';
      nameScreen.classList.add('hide');
      entryAnim.classList.add('show');
      spawnParticles();
      setTimeout(()=>{ entryText.textContent = `${name} ã®æ³¢é•·ã‚’åŒèª¿ä¸­â€¦`; }, 600);
      setTimeout(()=>{ finishEntry(); }, 1800);
    }

    function spawnParticles(){
      entryWrap.querySelectorAll('.pt').forEach(n=>n.remove());
      for(let i=0;i<64;i++){
        const s = document.createElement('span');
        s.className='pt';
        const sx = (Math.random()*-140-60) + 'px';
        const sy = (Math.random()*160-80) + 'px';
        const ex = (Math.random()*340+160) + 'px';
        const ey = (Math.random()*160-80) + 'px';
        s.style.setProperty('--sx', sx); s.style.setProperty('--sy', sy);
        s.style.setProperty('--ex', ex); s.style.setProperty('--ey', ey);
        s.style.left = '50%'; s.style.top = '50%';
        s.style.animationDelay = (Math.random()*1.4).toFixed(2)+'s';
        s.style.opacity = 0.6 + Math.random()*0.4;
        entryWrap.appendChild(s);
      }
    }

    function finishEntry(){
      const name = localStorage.getItem('vib_name') || 'ã‚ãªãŸ';
      welcomeName.textContent = name;
      onboarding.style.display = 'none';
      stage.style.display = 'grid';
      pushHistory('ãƒ‡ãƒ¢æº–å‚™å®Œäº†ã€‚Vibã¸ã‚ˆã†ã“ãã€‚');
    }

    // ===== Simple tab routing =====
    const tabs=[...document.querySelectorAll('.tab')];
    const views={home:document.getElementById('home'), radar:document.getElementById('radar'), matches:document.getElementById('matches'), profile:document.getElementById('profile')};
    tabs.forEach(t=>t.addEventListener('click',()=>{
      tabs.forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      Object.values(views).forEach(v=>v.classList.remove('active'));
      views[t.dataset.view].classList.add('active');
    }));

    // ===== Demo state =====
    const names=['Sora','Ren','Aoi','Mio','Kai','Yui','Noa','Haru','Rio','Nagi'];
    const moods=['é™ã‘ã•','æ¢ç©¶å¿ƒ','ã‚„ã•ã—ã•','é›†ä¸­','å¸Œæœ›','æ„Ÿè¬','èª å®Ÿã•','ä½™ç™½'];
    let stats={vibes:0, encounters:0, matches:0};
    const elV=document.getElementById('statVibes');
    const elE=document.getElementById('statEncounters');
    const elM=document.getElementById('statMatches');
    const hList=document.getElementById('history');
    const mList=document.getElementById('matchList');
    const noMatch=document.getElementById('noMatchMsg');

    function updateStats(){elV.textContent=stats.vibes; elE.textContent=stats.encounters; elM.textContent=stats.matches}

    function pushHistory(text){
      const item=document.createElement('div');
      item.className='item';
      item.innerHTML=`<div class="avatar">âœ¨</div><div><div>${text}</div><div class="meta">${ts()}</div></div>`;
      hList.prepend(item);
    }

    function pushMatch(entry){
      const item=document.createElement('div');
      item.className='item';
      item.innerHTML=`<div class="avatar">${entry.icon}</div><div><div><b>${entry.name}</b> ã¨å…±é³´ã—ã¾ã—ãŸï¼ˆ${entry.compat}%ï¼‰</div><div class="meta">${entry.tags.join(' / ')} ãƒ» ${ts()}</div></div>`;
      mList.prepend(item); noMatch.style.display='none';
    }

    function ts(){
      const d=new Date();
      return `${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')}`;
    }

    // ===== Radar demo =====
    const zone=document.getElementById('encounterZone');

    function fakeWalk(){
      pushHistory('å‘¨å›²ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã—ãŸã€‚ã‚ãªãŸã®æ³¢é•·ã¯å®‰å®šã—ã¦ã„ã¾ã™ã€‚');
    }

    function simulateEncounter(){
      stats.encounters++; updateStats();
      const name=names[Math.floor(Math.random()*names.length)];
      const tag1=moods[Math.floor(Math.random()*moods.length)];
      const tag2=moods[Math.floor(Math.random()*moods.length)];
      const compat= 70 + Math.floor(Math.random()*30); // 70-99
      const icon=['ğŸ§‘â€ğŸš€','ğŸ§‘â€ğŸ¤','ğŸ§‘â€ğŸ’»','ğŸ§‘â€ğŸ”¬','ğŸ§‘â€ğŸ¨','ğŸ§‘â€ğŸš´','ğŸ§˜','ğŸ§‘â€ğŸ³'][Math.floor(Math.random()*8)];

      zone.innerHTML = `
        <div class="encounter">
          <div class="row">
            <div class="avatar">${icon}</div>
            <div>
              <div><b>${name}</b></div>
              <div class="muted">${tag1}ãƒ»${tag2}</div>
            </div>
            <div class="compat">${compat}%</div>
          </div>
          <div style="display:flex; gap:10px; margin-top:12px">
            <button class="btn primary" onclick='sendVibe(${JSON.stringify({name: ""}).replace("\"\"","\"${name}\"")})'>éè¨€èªã€Œã„ã„ã­ï¼ã€ã‚’é€ã‚‹</button>
            <button class="btn" onclick="dismissEncounter()">ã‚¹ãƒ«ãƒ¼</button>
          </div>
        </div>`;

      // safer payload construction
      const payload = {name, tags:[tag1,tag2], compat, icon};
      const primaryBtn = zone.querySelector('.btn.primary');
      primaryBtn.onclick = ()=> sendVibe(payload);

      // subtle ripple feedback on radar
      const r=document.getElementById('radar');
      r.animate([
        {boxShadow:'inset 0 0 40px rgba(102,227,255,.2), 0 0 40px rgba(102,227,255,.2)'},
        {boxShadow:'inset 0 0 80px rgba(158,123,255,.55), 0 0 80px rgba(158,123,255,.55)'}
      ],{duration:600, direction:'alternate'});

      pushHistory(`${name} ã¨ã™ã‚Œé•ã„ã¾ã—ãŸï¼ˆ${compat}%ï¼‰`);
    }

    function dismissEncounter(){ zone.innerHTML=''; }

    function sendVibe(payload){
      stats.vibes++; stats.matches++; updateStats();
      pushMatch(payload); pushHistory(`éè¨€èªã€Œã„ã„ã­ï¼ã€ã‚’é€ä¿¡ â†’ ${payload.name} ã¨å…±é³´`);
      showOverlay(payload);
      zone.innerHTML='';
    }

    // ===== Overlay controls =====
    const overlay=document.getElementById('overlay');
    const other=document.getElementById('other');
    const text=document.getElementById('matchText');

    function showOverlay(p){
      overlay.classList.add('show');
      other.textContent=p.icon;
      text.textContent=`${p.name} ã¨ ${p.compat}% ã®å…±æ„Ÿãƒªãƒ³ã‚¯ï¼`;
    }
    function closeOverlay(){ overlay.classList.remove('show'); }

    // ===== Like button on home =====
    function toggleLike(btn){ btn.classList.toggle('active'); if(btn.classList.contains('active')){ pushHistory('ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã§é™ã‹ãªã€Œã„ã„ã­ã€ã‚’é€ã‚Šã¾ã—ãŸã€‚'); stats.vibes++; updateStats(); } }

    // If user revisits, skip onboarding
    (function init(){
      const saved = localStorage.getItem('vib_name');
      if(saved){
        welcomeName.textContent = saved;
        onboarding.style.display = 'none';
        stage.style.display = 'grid';
        pushHistory('å†è¨ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚');
      }
    })();

// ===== Re-experience (reset onboarding) =====
    ;function resetOnboarding(){
    localStorage.removeItem('vib_name');
    alert('ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚å†èª­ã¿è¾¼ã¿ã™ã‚‹ã¨ã€å…¥å ´ç”»é¢ã‹ã‚‰å†ä½“é¨“ã§ãã¾ã™ã€‚');
    location.reload();
}

  </script>
</body>
</html>
